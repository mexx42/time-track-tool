<tal:block metal:use-macro="templates/page/macros/icing">
<tal:block metal:fill-slot="create_or_query">
 <tal:block 
  metal:use-macro="templates/page/macros/create_or_query_new_tracker_item" />
</tal:block>

<tal:block metal:fill-slot="content">
 <tal:block tal:define=
  "batch request/batch;
   pdict python: utils.properties_dict (db, context);
   vst python: db._db.user_status.lookup ('valid');
   props python:
    ( utils.ExtProperty (utils, pdict ['id'])
    , utils.ExtProperty (utils, pdict ['title'])
    , utils.ExtProperty (utils, pdict ['responsible'])
    , utils.ExtProperty (utils, pdict ['requester'])
    , utils.ExtProperty (utils, pdict ['status'],           multiselect = 1)
    , utils.ExtProperty (utils, pdict ['organisation'],     multiselect = 1)
    , utils.ExtProperty (utils, pdict ['department'],       multiselect = 1)
    , utils.ExtProperty (utils, pdict ['time_project'],     multiselect = 1)
    , utils.ExtProperty (utils, pdict ['sap_reference'])
    , utils.ExtProperty
        ( utils, pdict ['time_project']
        , searchable = False
        , sortable   = False
        , searchname = 'time_project.description'
        , helpname   = 'time_project.description'
        )
    , utils.ExtProperty (utils, pdict ['sap_cc'],           multiselect = 1)
    , utils.ExtProperty (utils, pdict ['purchase_type'],    multiselect = 1)
    , utils.ExtProperty (utils, pdict ['safety_critical'])
    , utils.ExtProperty (utils, pdict ['part_of_budget'],   multiselect = 1)
    , utils.ExtProperty (utils, pdict ['frame_purchase'])
    , utils.ExtProperty (utils, pdict ['frame_purchase_end'])
    , utils.ExtProperty (utils, pdict ['continuous_obligation'])
    , utils.ExtProperty (utils, pdict ['contract_term'])
    , utils.ExtProperty (utils, pdict ['intended_duration'])
    , utils.ExtProperty (utils, pdict ['terms_conditions'], multiselect = 1)
    , utils.ExtProperty (utils, pdict ['renegotiations'])
    , utils.ExtProperty (utils, pdict ['delivery_deadline'])
    , utils.ExtProperty (utils, pdict ['total_cost'])
    , utils.ExtProperty (utils, pdict ['pr_currency'])
    , utils.ExtProperty (utils, pdict ['creation'])
    , utils.ExtProperty
        ( utils, pdict ['creator']
        , help_props  = ['realname']
        , filter = dict (status = vst)
        )
    , utils.ExtProperty (utils, pdict ['activity'])
    , utils.ExtProperty
        ( utils, pdict ['actor']
        , help_props  = ['realname']
        , filter = dict (status = vst)
        )
    , utils.ExtProperty
        ( utils, pdict ['nosy']
        , help_props  = ['realname']
        , filter = dict (status = vst)
        )
    , utils.ExtProperty
        ( utils, pdict ['offer_items']
        , searchable  = True
        , sortable    = False
        , searchname  = 'offer_items.supplier'
        )
    , utils.ExtProperty
        ( utils, pdict ['offer_items']
        , searchable  = True
        , sortable    = False
        , searchname  = 'offer_items.pr_supplier'
        , multiselect = True
        )
    );
   "
  tal:condition="context/is_view_ok">

  <tal:block metal:use-macro="templates/page/macros/search_results"/>
  <tal:block metal:use-macro="templates/page/macros/simple_search_form"/>
 </tal:block>
</tal:block>
</tal:block>
