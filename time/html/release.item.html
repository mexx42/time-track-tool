<tal:block metal:use-macro="templates/page/macros/icing">

 <title metal:fill-slot="head_title">
  <span tal:condition="context/id"
        tal:replace="string:Release: ${context/id} by ${context/creator}"></span>
  <span tal:condition="not:context/id"
        tal:replace="string:Create New Release"></span>
 </title>

 <tal:block metal:fill-slot="content">
  <tal:block metal:use-macro="templates/page/macros/ttt_issue">
   <tal:block metal:fill-slot="ttt_issue_content">
    <tr tal:condition="context/id">
     <th>Milestones</th>
     <td>
      <table>
       <tr>
        <th>&nbsp; </th>
        <th>planned</th>
        <th>reached</th>
       </tr>
       <tr tal:repeat="m context/milestones">
        <th tal:content="m/name"
            tal:attributes="title m/description"></th>
        <td tal:content="m/planned/plain"></td>
        <td tal:content="structure m/reached/field"></td>
       </tr>
      </table>
     </td>
    </tr>

    <tr tal:condition="context/id"
        tal:define="available python:[]">
     <th>Documents</th>
     <td>
      <table class="files"
             tal:condition="context/documents">
       <tr>
        <th>Type</th>
        <th>Status</th>
        <th>Responsible</th>
       </tr>
       <tr tal:repeat="doc context/documents/reverse">
        <td tal:define="_xx python:available.append(doc.type.id)">
         <a tal:attributes="href string:javascript:help_window('document${doc/id}','800','600')"
            tal:content="doc/type/description"></a>
        </td>
        <td tal:content="doc/status/plain"></td>
        <td tal:content="doc/responsible/plain"></td>
       </tr>
      </table>
      <table border="0">
       <tr>
        <th>Add:</th>
        <td>
         <select name="document-1@type">
          <option selected="selected" value="-1">- select Document Type -</option>
          <tal:block tal:repeat="t db/document_type/list">
          <option tal:condition="python:t.id not in available"
                  tal:attributes="value t/id"
                  tal:content="string:${t/description} (${t/name})"></option>
          </tal:block>
         </select>
        </td>
       </tr>
      </table>
      <input type="hidden" name="@link@documents" value="document-1" />
     </td>
    </tr>

    <tr tal:condition="context/features">
     <th>Features</th>
     <td><span tal:repeat="f context/features">
         <a tal:attributes="href string:feature${f/id}"
            tal:content="string:[feature${f/id}] ${f/title}"></a><br>
         </span>
     </td>
    </tr>

    <tr tal:condition="context/planned_fixes">
     <th>Planned Fixes</th>
     <td><span tal:repeat="f context/planned_fixes">
         <a tal:attributes="href string:feature${f/id}"
            tal:content="string:[feature${f/id}] ${f/title}"></a><br>
         </span>
     </td>
    </tr>

    <tr tal:condition="context/bugs">
     <th>Bugs</th>
     <td><span tal:repeat="f context/bugs">
         <a tal:attributes="href string:feature${f/id}"
            tal:content="string:[feature${f/id}] ${f/title}"></a><br>
         </span>
     </td>
    </tr>

   </tal:block>
  </tal:block>
 </tal:block>

</tal:block>
