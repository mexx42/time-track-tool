<tal:block metal:use-macro="templates/page/macros/icing">

 <title metal:fill-slot="head_title">
  <span tal:condition="context/id"
        tal:replace="string:Feature: ${context/id} by ${context/creator}"></span>
  <span tal:condition="not:context/id"
        tal:replace="string:Create New Feature"></span>
 </title>

 <tal:block metal:fill-slot="create_or_query">
  <tal:block 
   metal:use-macro="templates/page/macros/create_or_query_new_tracker_item" />
 </tal:block>

 <tal:block metal:fill-slot="content">
  <tal:block metal:use-macro="templates/page/macros/ttt_issue">
   <tal:block metal:fill-slot="ttt_issue_content">
<tal:block tal:define="documents
                           python:db.task.filter ( filterspec = { 'kind'    : [1, 2]
                                                                , 'feature' : context.id
                                                                }
                                                 , group      = ( '+', 'status')
                                                 , sort       = ( '+', 'id'    )
                                                 );
                       implementation_tasks
                           python:db.task.filter ( filterspec = { 'kind'    : 3
                                                                , 'feature' : context.id
                                                                }
                                                 , group      = ( '+', 'status')
                                                 , sort       = ( '+', 'id'    )
                                                 );
                       testcases
                           python:db.task.filter ( filterspec = { 'kind'    : 4
                                                                , 'feature' : context.id
                                                                }
                                                 , group      = ( '+', 'status')
                                                 , sort       = ( '+', 'id'    )
                                                 );
                       documentation_tasks
                           python:db.task.filter ( filterspec = { 'kind'    : 5
                                                                , 'feature' : context.id
                                                                }
                                                 , group      = ( '+', 'status')
                                                 , sort       = ( '+', 'id'    )
                                                 );
                       ">
    <tr tal:condition="context/id">
     <th>Release</th>
     <td class="task_list">
      <span tal:content="structure context/release/menu"
            tal:condition="context/is_edit_ok"></span>
      <tal:block tal:condition="context/release/isset"
                 tal:define="item context/release">
       <a tal:attributes="href item/designator;
                          class string:release_${item/status}"
          tal:content="structure string:${item/designator} (${item/status}, ${item/responsible/nickname})"></a>
      </tal:block>
     </td>
    </tr>

    <tr tal:condition="context/id">
     <th>Status</th>
     <td>
      <select name="status"
              tal:define="ok context/status/transitions"
              tal:condition="context/is_edit_ok">
       <option tal:attributes="value context/status/id"
               tal:content="context/status/name"></option>
       <tal:block tal:repeat="state db/feature_status/list">
       <option tal:condition="python:state.id in ok"
               tal:attributes="
                   value state/id;
                selected python:state.id == context.status.id"
               tal:content="state/name">
       </option>
       </tal:block>
      </select>
      <span tal:condition="context/is_only_view_ok"
            tal:content="context/status"/>
     </td>
    </tr>

    <tr tal:condition="python:[t for t in testcases
                              if t.status.plain () == 'accepted']">
     <th>Test OK</th>
     <td tal:condition="context/test_ok/_value"
         class="test_ok">All testcases passed !</td>
     <td tal:condition="not:context/test_ok/_value"
         class="test_failed">Some testcases failed - see below !!!</td>
    </tr>

    <tr>
     <th>Stakeholder</th>
     <td>
      <textarea tal:content="context/stakeholder/plain"
                tal:attributes="readonly context/is_only_view_ok"
                name="stakeholder"
                wrap="hard"
                rows="3"
                cols="80"></textarea>
     </td>
    </tr>

    <tr tal:condition="python:context.is_edit_ok () or context.depends">
     <th>Depends on</th>
     <td class="task_list">
      <span tal:content="structure context/depends/field"/>
      <span tal:condition="context/is_edit_ok"
            tal:replace="structure python:db.feature.classhelp
                 ( 'id,title,responsible'
                 , property='depends'
                 , width='600'
                 , pagesize=500
                 )" />
      <br>
      <tal:block tal:define="items context/depends;
                             klassname string:feature">
       <tal:block metal:use-macro="templates/page/macros/ttt_task_list"/>
      </tal:block>
     </td>
    </tr>

    <tr tal:condition="python:context.is_edit_ok () or context.needs">
     <th>Needs</th>
     <td class="task_list">
      <span tal:content="structure context/needs/field"/>
      <span tal:condition="context/is_edit_ok"
            tal:replace="structure python:db.feature.classhelp
                 ( 'id,title,responsible'
                 , property='needs'
                 , width='600'
                 , pagesize=500
                 )" />
      <br>
      <tal:block tal:define="items context/needs;
                             klassname string:feature">
       <tal:block metal:use-macro="templates/page/macros/ttt_task_list"/>
      </tal:block>
     </td>
    </tr>

    <tr tal:condition="context/defects">
     <th>Defects</th>
     <td class="task_list">
      <tal:block tal:define="items context/defects;
                             klassname string:defect">
       <tal:block metal:use-macro="templates/page/macros/ttt_task_list"/>
      </tal:block>
     </td>
    </tr>

    <tr tal:condition="documents">
     <th>Documents</th>
     <td class="task_list">
      <tal:block tal:define="items documents;
                             klassname string:task">
       <tal:block metal:use-macro="templates/page/macros/ttt_task_list"/>
      </tal:block>
     </td>
    </tr>

    <tr tal:condition="implementation_tasks">
     <th>Implementation</th>
     <td class="task_list">
      <tal:block tal:define="items implementation_tasks;
                             klassname string:task">
       <tal:block metal:use-macro="templates/page/macros/ttt_task_list"/>
      </tal:block>
     </td>
    </tr>

    <tr tal:condition="testcases">
     <th>Testcases</th>
     <td class="task_list">
      <tal:block tal:define="items testcases;
                             klassname string:task">
       <tal:block metal:use-macro="templates/page/macros/ttt_task_list"/>
      </tal:block>
     </td>
    </tr>

    <tr tal:condition="documentation_tasks">
     <th>Documentation</th>
     <td class="task_list">
      <tal:block tal:define="items documentation_tasks;
                             klassname string:task">
       <tal:block metal:use-macro="templates/page/macros/ttt_task_list"/>
      </tal:block>
     </td>
    </tr>

    <tr class="add_new"
        tal:condition="context/is_edit_ok">
     <th>Add Task</th>
     <td>
      <table>
       <tr>
        <th class="required">Title</th>
        <td><input type="text" name="task-1@title" size="40"></td>
       </tr>
       <tr>
        <th class="required">Kind</th>
        <td>
         <select name="task-1@kind">
          <option selected="selected" value="-1">- select kind of task to add -</option>
          <option tal:repeat="k db/task_kind/list"
                  tal:attributes="value k/id"
                  tal:content="k/description">
          </option>
         </select>
        </td>
       </tr>
       <tr>
        <th>Resp.</th>
        <td>
         <tal:block tal:define="name      string:task-1@responsible;
                                form      string:itemSynopsis;
                                dont_care string:- select responsible of task to add -;
                                selected  string:0">
          <tal:block metal:use-macro="templates/userlist/macros/user"></tal:block>
         </tal:block>
        </td>
       </tr>
      </table>
      <input type="hidden" name="@link@tasks" value="task-1" />
     </td>
    </tr>

</tal:block>
   </tal:block>
  </tal:block>
 </tal:block>

</tal:block>
<!-- SHA: 3760bdfed60a36d760dfd9ec6b5a07f4c5ad351e -->
