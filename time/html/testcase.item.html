<tal:block metal:use-macro="templates/page/macros/icing">

 <title metal:fill-slot="head_title">
  <span tal:condition="context/id"
        tal:replace="string:Document: ${context/id} by ${context/creator}"></span>
  <span tal:condition="not:context/id"
        tal:replace="string:Create New Testcase"></span>
 </title>

 <tal:block metal:fill-slot="content">
  <tal:block metal:use-macro="templates/page/macros/ttt_issue">
   <tal:block metal:fill-slot="ttt_issue_content">
    <tr>
     <th>Status</th>
     <td>
      <select name="status"
              tal:define="ok context/status/transitions">
       <option tal:attributes="value context/status/id"
               tal:content="context/status/name"></option>
       <tal:block tal:repeat="state db/work_package_status/list">
       <option tal:condition="python:state.id in ok"
               tal:attributes="
                   value state/id;
                selected python:state.id == context.status.id"
               tal:content="state/name">
       </option>
       </tal:block>
      </select>
     </td>
    </tr>

    <tr>
     <th>Test Ok</th>
     <td tal:condition="context/is_edit_ok"
         tal:content="structure context/test_ok/field">
     </td>
     <td tal:condition="not:context/is_edit_ok"
         tal:content="context/test_ok">
     </td>
    </tr>

    <tr>
     <th>Part of</th>
     <td><a tal:attributes="href context/feature/designator;
                            class string:feature_${context/feature/status}"
            tal:content="context/feature/title"></a>
     </td>
    </tr>

    <tr>
     <th>Depends on</th>
     <td colspan="3">
      <span tal:content="structure context/depends/field"/>
      <span tal:replace="structure python:db.documentation_task.classhelp
                                             ( 'id,title,responsible'
                                             , property='depends'
                                             , width='600')" /><br>
      <tal:block tal:repeat="f context/depends">
       <a tal:attributes="href f/designator;
                          class string:work_package_${f/status/plain}"
          tal:content="string:${f/title}"
       ></a><br>
      </tal:block>
     </td>
    </tr>

    <tr>
     <th>Needs</th>
     <td colspan="3">
      <span tal:content="structure context/needs/field"/>
      <span tal:replace="structure python:db.documentation_task.classhelp
                                             ( 'id,title,responsible'
                                             , property='needs'
                                             , width='600')" /><br>
      <tal:block tal:repeat="f context/needs">
       <a tal:attributes="href f/designator;
                          class string:work_package_${f/status/plain}"
          tal:content="string:${f/title}"
       ></a><br>
      </tal:block>
     </td>
    </tr>

    <tr>
     <th>Files</th>
     <td colspan="3">
      <tal:block metal:use-macro="templates/page/macros/ttt_issue_pdf_files"/>
     </td>
    </tr>
   </tal:block>
  </tal:block>
 </tal:block>

</tal:block>
